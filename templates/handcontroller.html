<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/style/handcontroller.css">
    <title>Emotion Game</title>
</head>

<body>

    <!-- Emoji Phase -->
    <div id="hc" class="container text-center mt-4" style="display: block;">
        <h1>Hand Controller</h1>  

        <div id="camera-feed-container">
            <img id="video-feed" style="display: none; top: 200;" alt="Video Feed">
        </div>

        <button id="start-camera">Start</button>
        <button id="stop-camera" style="display: none;">Stop</button>
    </div>

    <script>
        const videoElement = document.getElementById("video-feed");
        const startCameraButton = document.getElementById("start-camera");
        const stopCameraButton = document.getElementById("stop-camera");
        
        // Start camera
        startCameraButton.addEventListener("click", async () => {
            try {
                const response = await fetch("/start_camera", { method: "POST" });
                const data = await response.json();

                if (data.status === "Camera started") {
                    videoElement.style.display = "block";
                    videoElement.src = "/video_feed";
                    startCameraButton.style.display = "none";
                    stopCameraButton.style.display = "inline";
                }
            } catch (error) {
                alert("Failed to start the camera: " + error.message);
            }
        });

        // Stop camera
        stopCameraButton.addEventListener("click", async () => {
            try {
                const response = await fetch("/stop_camera", { method: "POST" });
                const data = await response.json();

                if (data.status === "Camera stopped") {
                    videoElement.style.display = "none";
                    videoElement.src = "";
                    startCameraButton.style.display = "inline";
                    stopCameraButton.style.display = "none";
                }
            } catch (error) {
                alert("Failed to stop the camera: " + error.message);
            }

            async function processFrames() {
            try {
                const response = await fetch("/process_frame", { method: "POST" });
                const data = await response.json();
                const stopResponse = await fetch("/stop_camera", { method: "POST" });
                if (stopResponse.ok) {
                    console.log("Camera stopped successfully.");
                } else {
                    console.error("Failed to stop the camera.");
                }
            } catch (error) {}
        }
        });
    </script>
</body>
</html>
